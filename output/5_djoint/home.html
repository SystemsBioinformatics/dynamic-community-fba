<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. Dynamic Joint FBA &mdash; dynamic-community-fba  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Dynamic Parallel FBA" href="../6_parallel_dfba/home.html" />
    <link rel="prev" title="4. The community model" href="../4_community_matrix/home.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            dynamic-community-fba
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1_installation/home.html">1. Installation and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_getting_started/home.html">2. CBMPy Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_DynamicFBA/home.html">3. Dynamic FBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_community_matrix/home.html">4. The community model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Dynamic Joint FBA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../6_parallel_dfba/home.html">6. Dynamic Parallel FBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_endpoint_fba/home.html">7. EndPointFBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_Advanced/home.html">8. Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../9_faq/home.html">9. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_API/DCFBA.html">10. API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">dynamic-community-fba</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">5. Dynamic Joint FBA</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/5_djoint/home.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dynamic-joint-fba">
<h1>5. Dynamic Joint FBA<a class="headerlink" href="#dynamic-joint-fba" title="Permalink to this heading"></a></h1>
<p>Dynamic Joint Flux Balance Analysis (djFBA) is a method to dynamically model microbial communities. The core principle of djFBA is the formation of
<cite>community biomass</cite>, denoted as <code class="docutils literal notranslate"><span class="pre">X_c</span></code>. Which is introduced in the <code class="docutils literal notranslate"><span class="pre">CommunityModel</span></code> to be the total sum of individual biomasses. The formation of
this mock species is than set to be the objective function for FBA.</p>
<p>Using this in combination with the static optimization approaches as introduced in the dFBA section. We now have our first method to model microbial communities!</p>
<p>** citation from Dynamic Joint FBA</p>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h2>
<p>Here we will give use the example of a combining the  <em>E. coli core metabolism</em> model with the <em>Streptococcus thermophilus</em> (iRZ476) model.
To perform the Dynamic Joint FBA we first define the <code class="docutils literal notranslate"><span class="pre">CommunityModel</span></code> and use this to initialize a <code class="docutils literal notranslate"><span class="pre">DynamicJointFBA</span></code> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cbmpy.CBModel</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">dcFBA.Models</span> <span class="kn">import</span> <span class="n">CommunityModel</span>
<span class="kn">from</span> <span class="nn">dcFBA.DynamicModels</span> <span class="kn">import</span> <span class="n">DynamicJointFBA</span>
<span class="kn">from</span> <span class="nn">dcFBA.DefaultModels</span> <span class="kn">import</span> <span class="n">read_default_model</span>

<span class="n">model1</span><span class="p">:</span> <span class="n">Model</span> <span class="o">=</span> <span class="n">read_default_model</span><span class="p">(</span><span class="s2">&quot;e_coli_core&quot;</span><span class="p">)</span>
<span class="n">model2</span><span class="p">:</span> <span class="n">Model</span> <span class="o">=</span> <span class="n">read_default_model</span><span class="p">(</span><span class="s2">&quot;strep_therm&quot;</span><span class="p">)</span>

<span class="c1"># Set the import bounds for glucose in both models</span>
<span class="n">model1</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;R_GLCpts&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setUpperBound</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;R_GLCpts&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setUpperBound</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># The biomass reactions ids</span>
<span class="n">biomass_reaction_model_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;R_BIOMASS_Ecoli_core_w_GAM&quot;</span>
<span class="n">biomass_reaction_model_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;R_biomass_STR&quot;</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">CommunityModel</span><span class="p">(</span>
    <span class="p">[</span><span class="n">model1</span><span class="p">,</span> <span class="n">model2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">biomass_reaction_model_1</span><span class="p">,</span> <span class="n">biomass_reaction_model_2</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;ecoli&quot;</span><span class="p">,</span> <span class="s2">&quot;strep&quot;</span><span class="p">],</span>
<span class="p">)</span>  <span class="c1"># Define the community model</span>

<span class="n">dynamic_joint_fba</span> <span class="o">=</span> <span class="n">DynamicJointFBA</span><span class="p">(</span>
    <span class="n">cm</span><span class="p">,</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="p">{</span>
        <span class="s2">&quot;M_glc__D_e&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;M_succ_e&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;M_glu__L_e&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;M_gln__L_e&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;M_lcts_e&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>  <span class="c1"># Create a DynamicJointFBA object, set the initial concentrations of glucose and lactose to 100</span>
</pre></div>
</div>
<p>Now that the model is in place we can run the simulation using time steps of 0.1:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dynamic_joint_fba</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>The simulate method conducts the simulation and stores all values of biomass concentrations, metabolite concentrations, and fluxes at each time point. You can access these values by retrieving the respective objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">biomasses</span> <span class="o">=</span> <span class="n">dynamic_joint_fba</span><span class="o">.</span><span class="n">get_biomasses</span><span class="p">()</span>
<span class="n">metabolites</span> <span class="o">=</span> <span class="n">dynamic_joint_fba</span><span class="o">.</span><span class="n">get_metabolites</span><span class="p">()</span>
<span class="n">time_points</span> <span class="o">=</span> <span class="n">dynamic_joint_fba</span><span class="o">.</span><span class="n">get_time_points</span><span class="p">()</span>
<span class="n">fluxes</span> <span class="o">=</span> <span class="n">dynamic_joint_fba</span><span class="o">.</span><span class="n">get_fluxes</span><span class="p">()</span>
</pre></div>
</div>
<p>Since the fluxes are stored are the aggregated fluxes (the flux multiplied by the total amount of biomass present at that time), we can also restore the specific flux for a reaction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">specific_flux_values</span> <span class="o">=</span> <span class="n">dynamic_joint_fba</span><span class="o">.</span><span class="n">get_specific_flux_values</span><span class="p">(</span><span class="s2">&quot;R_GLCpts_ecoli&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can now easily plot the species concentration over time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">time_points</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">[</span><span class="s2">&quot;M_glc__D_e&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;[Glucose]&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">time_points</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">[</span><span class="s2">&quot;M_lcts_e&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;[Lactose]&quot;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/Metabolites_DJFBA.png"><img alt="Biomass concentrations" class="align-center" src="../_images/Metabolites_DJFBA.png" style="width: 500px;" /></a>
<p>And the biomasses of both species over time</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">biomasses</span><span class="p">[</span><span class="s2">&quot;ecoli&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ecoli&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">biomasses</span><span class="p">[</span><span class="s2">&quot;strep&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;strep&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/Biomass_DJFBA.png"><img alt="Biomass concentrations" class="align-center" src="../_images/Biomass_DJFBA.png" style="width: 500px;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../4_community_matrix/home.html" class="btn btn-neutral float-left" title="4. The community model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../6_parallel_dfba/home.html" class="btn btn-neutral float-right" title="6. Dynamic Parallel FBA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, S.C.M.A. Wijnen, F. Moro.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>